"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[659],{4659:function(e,t,a){a.r(t),a.d(t,{default:function(){return U}});var n=a(5893),s=a(7294),c=a(6784),i=a.n(c),o=a(1485),l=a(8751),r=a(640),m=a(2627),d=a(7258),u=e=>{let{isOpen:t,onClose:a,blockName:s}=e;if(!t)return null;let c=new d.f({name:s,quantity:1});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(i().blockDetailsOverlay),onClick:a}),(0,n.jsx)("div",{className:"".concat(i().blockDetailsDrawer," ").concat(t?i().open:""),children:(0,n.jsxs)("div",{className:i().blockDetailsContent,children:[(0,n.jsxs)("div",{className:i().blockDetailsHeader,children:[(0,n.jsx)("h2",{children:c.name}),(0,n.jsx)("button",{className:i().closeBtn,onClick:a,children:"\xd7"})]}),(0,n.jsxs)("div",{className:i().blockDetailsBody,children:[(0,n.jsx)("div",{className:i().blockDetailsImage,children:(0,n.jsx)("img",{src:c.getImageUrl(),alt:c.name})}),(0,n.jsxs)("div",{className:i().blockDetailsStat,children:[(0,n.jsx)("span",{className:i().statLabel,children:"Rarity:"}),(0,n.jsx)("span",{className:i().statValue,children:c.getBlock().rarity})]})]})]})})]})};let h=e=>{switch(e){case"Common":default:return"#aaaaaa";case"Uncommon":return"#55ff55";case"Rare":return"#5555ff";case"Epic":return"#aa00aa";case"Seasonal":return"#ff5555";case"Legendary":return"#ffaa00"}},x=e=>(0,m.K)("/assets/blocks/".concat(e,".png"));var k=e=>{let{isOpen:t,onClose:a,gameState:c,onBuyItem:o}=e,[l,d]=(0,s.useState)(!0),[k,p]=(0,s.useState)(null),v=(0,s.useRef)(null),g=r.o.items,j=l?g.filter(e=>c.currentBiome.getBiome().availablePickaxes.includes(e.name.toLowerCase())):g;(0,s.useEffect)(()=>{if(t&&v.current){let e=()=>{let e=v.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(i().hasScroll):e.classList.remove(i().hasScroll))};e();let t=new ResizeObserver(e);return t.observe(v.current),()=>{v.current&&t.unobserve(v.current),t.disconnect()}}},[t,j]);let b=(e,t)=>c.blockInventory.hasBlock(e,t),N=e=>{let{itemType:t,amount:a}=e.cost,n=c.blockInventory.getBlockQuantity(t);return n<a?"Need ".concat(a-n," more ").concat(t):"Buy (".concat(a," ").concat(t,")")},y=e=>{p(e)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(i().biomesOverlay," ").concat(t?i().biomesOverlayOpen:""),onClick:a}),(0,n.jsxs)("div",{className:"".concat(i().biomesDrawer," ").concat(t?i().biomesDrawerOpen:""),children:[(0,n.jsx)("div",{className:i().biomesDrawerHandle,onClick:a}),(0,n.jsxs)("div",{className:i().biomesDrawerHeader,children:[(0,n.jsx)("h2",{children:"Shop Pickaxes"}),(0,n.jsxs)("div",{className:i().toggleContainer,children:[(0,n.jsxs)("label",{className:i().toggleSwitch,children:[(0,n.jsx)("input",{type:"checkbox",checked:l,onChange:()=>{d(e=>!e)}}),(0,n.jsx)("span",{className:i().toggleSlider})]}),(0,n.jsx)("span",{className:i().toggleLabel,children:l?"Showing biome pickaxes only":"Showing all pickaxes"})]})]}),(0,n.jsx)("div",{ref:v,className:i().biomesDrawerContent,"data-drawer-type":"pickaxes",children:(0,n.jsx)("div",{className:i().biomesSection,children:(0,n.jsx)("div",{className:i().pickaxesGrid,children:j.map(e=>{let t=b(e.cost.itemType,e.cost.amount),a=h(e.rarity),s=x(e.cost.itemType);return(0,n.jsxs)("div",{className:i().pickaxeItem,children:[(0,n.jsxs)("div",{className:i().pickaxeImageContainer,children:[(0,n.jsx)("img",{src:"".concat((0,m.K)("/assets/pickaxes/".concat(e.name.toLowerCase(),".png"))),alt:"".concat(e.name," Pickaxe"),className:i().pickaxeItemImg}),(0,n.jsx)("div",{className:i().rarityBadge,style:{backgroundColor:a,top:"auto",bottom:"5px"},children:e.rarity})]}),(0,n.jsxs)("div",{className:i().pickaxeItemContent,children:[(0,n.jsxs)("div",{className:i().pickaxeInfo,children:[(0,n.jsxs)("div",{className:i().itemName,children:[e.name.charAt(0).toUpperCase()+e.name.slice(1)," Pickaxe"]}),(0,n.jsxs)("div",{className:i().itemDescription,children:["Strength: ",e.strength," | Durability: ",e.maxHealth," | Crit: ",100*e.critical,"%"]}),(0,n.jsxs)("div",{className:i().unlockCost,children:[(0,n.jsxs)("div",{className:i().costWithImage,children:[(0,n.jsx)("span",{children:"Cost: "}),(0,n.jsxs)("div",{className:i().costItemImgWrapper,onClick:()=>y(e.cost.itemType),children:[(0,n.jsx)("img",{src:s,alt:e.cost.itemType,className:i().costBlockImage,style:{width:"32px",height:"32px",cursor:"pointer"}}),(0,n.jsx)("div",{className:i().costItemBadge,children:e.cost.amount})]}),(0,n.jsx)("span",{className:t?i().affordableCost:i().unaffordableCost,children:e.cost.itemType})]}),(0,n.jsxs)("div",{children:["(You have: ",c.blockInventory.getBlockQuantity(e.cost.itemType),")"]})]})]}),(0,n.jsx)("button",{className:"".concat(i().buyPickaxeButton," ").concat(t?"":i().buyPickaxeButtonDisabled),onClick:()=>o(e.name,0),disabled:!t,children:N(e)})]})]},e.name)})})})})]}),(0,n.jsx)(u,{isOpen:null!==k,onClose:()=>{p(null)},blockName:k||""})]})},p=e=>{let{isOpen:t,onRestart:a}=e;return(0,n.jsx)("div",{className:"".concat(i().modal," ").concat(t?i().modalShow:""),children:(0,n.jsxs)("div",{className:i().modalContent,children:[(0,n.jsx)("h2",{children:"Game Over!"}),(0,n.jsx)("p",{children:"You've lost all your pickaxes!"}),(0,n.jsx)("button",{className:i().restartBtn,onClick:a,children:"Play Again"})]})})},v=e=>{let{onBiomeClick:t,currentPickaxe:a,currentBiome:c,picksToShow:o,minedBlock:l}=e,[r,d]=(0,s.useState)({x:0,y:0}),[u,h]=(0,s.useState)(!1),[x,k]=(0,s.useState)((null==c?void 0:c.currentHealth)||0),[p,v]=(0,s.useState)((0,m.K)("/assets/pickaxes/wood.webp")),[g,j]=(0,s.useState)(!1),[b,N]=(0,s.useState)(null),[y,f]=(0,s.useState)(!1),[C,I]=(0,s.useState)(null),[B,S]=(0,s.useState)([]),w=(0,s.useRef)(null);(0,s.useEffect)(()=>{a&&v(a.getImageUrl())},[a]),(0,s.useEffect)(()=>{if(o){N(o),j(!0);let e=setTimeout(()=>{j(!1)},1500);return()=>clearTimeout(e)}},[o]),(0,s.useEffect)(()=>{if(l){I(l),f(!0),P(l.imageUrl);let e=setTimeout(()=>{f(!1)},1500);return()=>clearTimeout(e)}},[l]);let P=e=>{if(!w.current)return;let t=w.current.getBoundingClientRect(),a=t.width,n=t.height,s=r.x||a/2,c=r.y||n/2,i=Math.floor(5*Math.random())+10,o=[];for(let t=0;t<i;t++){let a=s+(Math.floor(t/3)-1.5)*40+(10*Math.random()-5),i=c+(t%3-1)*40/2+(10*Math.random()-5),l=20*Math.random()+20,r=n-i+100,m=.7+.3*Math.random(),d=.2*Math.random();o.push({id:"block-".concat(Date.now(),"-").concat(t),x:a,y:i,size:l,rotation:0,fallX:0,fallY:r,delay:d,fallDuration:m,imageUrl:e})}S(o),setTimeout(()=>{S([])},2e3)};(0,s.useEffect)(()=>{let e=(null==c?void 0:c.currentHealth)||0;if(e<x&&w.current){let e=w.current;e.classList.add(i().shake),setTimeout(()=>{e.classList.remove(i().shake)},500)}k(e)},[null==c?void 0:c.currentHealth,x]);let D=()=>{h(!0),setTimeout(()=>h(!1),300)},_=(null==c?void 0:c.damagePercent)||100;return(0,n.jsxs)("div",{className:i().biomeContainer,children:[(0,n.jsxs)("div",{ref:w,className:"".concat(i().biome),onMouseMove:e=>{if(w.current){let t=w.current.getBoundingClientRect();d({x:e.clientX-t.left,y:e.clientY-t.top})}},onClick:()=>{t(),D()},style:{backgroundImage:"url(".concat(null==c?void 0:c.getImageUrl(),")"),backgroundSize:"cover",backgroundPosition:"center"},children:[g&&b&&(0,n.jsxs)("div",{className:i().scoreFlash,children:["+",b]}),y&&C&&(0,n.jsx)("div",{className:i().minedBlock,style:{top:"50%",left:"50%",backgroundImage:"url(".concat(C.imageUrl,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),B.map(e=>(0,n.jsx)("div",{className:i().fallingBlock,style:{left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),width:"".concat(e.size,"px"),height:"".concat(e.size,"px"),backgroundImage:"url(".concat(e.imageUrl,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",transform:"rotate(".concat(e.rotation,"deg)"),"--rotation":"".concat(e.rotation,"deg"),"--fall-x":"".concat(e.fallX,"px"),"--fall-y":"".concat(e.fallY,"px"),"--delay":"".concat(e.delay,"s"),"--duration":"".concat(e.fallDuration,"s")}},e.id)),_<100&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:i().crackOverlay,style:{opacity:Math.max(.2,1-_/100),backgroundImage:"url(".concat((0,m.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(1+(1-_/100),")"),filter:"contrast(".concat(100+(100-_),"%) brightness(").concat(100+(100-_)/2,"%)")}}),_<50&&(0,n.jsx)("div",{className:"".concat(i().crackOverlay," ").concat(i().secondaryCracks),style:{opacity:Math.max(.1,.8-_/50),backgroundImage:"url(".concat((0,m.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(.7+(1-_/50),") rotate(45deg)")}}),_<25&&(0,n.jsx)("div",{className:"".concat(i().crackOverlay," ").concat(i().criticalCracks),style:{opacity:Math.max(.15,.9-_/25),backgroundImage:"url(".concat((0,m.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(.9+(1-_/25),") rotate(-30deg)")}})]}),(0,n.jsx)("div",{className:i().pickaxeCursor,style:{left:"".concat(r.x,"px"),top:"".concat(r.y,"px")},children:(0,n.jsx)("img",{src:p,alt:"Pickaxe cursor",className:u?i().swingAnimation:""})})]}),(0,n.jsxs)("div",{className:i().horizontalHealthContainer,children:[(0,n.jsx)("div",{className:i().horizontalHealthBar,style:{width:"".concat(_,"%"),backgroundColor:_>60?"#72CB3B":_>30?"#FFCC00":"#FF6B6B"}}),(0,n.jsxs)("div",{className:i().horizontalHealthText,children:[Math.ceil(_),"%"]})]})]})},g=e=>{let{pickaxe:t,isSelected:a,onClick:c,className:o="",showTooltip:l=!0}=e,[r,m]=(0,s.useState)(!1),d=t.getPickaxe().maxHealth,u=t.health/d*100,h=t.getPickaxe(),x=u<=50?"rgb(".concat(255,", ").concat(Math.round(59+u/50*158),", ").concat(Math.round(59+-(u/50*59)),")"):"rgb(".concat(Math.round(255-(u-50)/50*141),", ").concat(Math.round(217-(u-50)/50*14),", ").concat(Math.round(0+(u-50)/50*59),")");return(0,n.jsxs)("div",{className:"".concat(i().inventorySlot," ").concat(a?i().selected:""," ").concat(o),onClick:()=>{c(t.id)},onMouseEnter:()=>{m(!0)},onMouseLeave:()=>{m(!1)},title:"".concat(t.type," Pickaxe - Health: ").concat(t.health,"/").concat(d),children:[(0,n.jsx)("img",{src:t.getImageUrl(),alt:t.type,className:i().inventoryItem}),(0,n.jsx)("div",{className:i().durabilityBar,children:(0,n.jsx)("div",{className:i().durabilityFill,style:{width:"".concat(u,"%"),backgroundColor:x}})}),l&&r&&(0,n.jsxs)("div",{className:i().quickItemTooltip,children:[(0,n.jsxs)("div",{className:i().quickItemName,children:[t.type.charAt(0).toUpperCase()+t.type.slice(1)," Pickaxe"]}),(0,n.jsxs)("div",{className:i().quickItemStats,children:[(0,n.jsxs)("div",{children:["Health: ",t.health,"/",d]}),(0,n.jsxs)("div",{children:["Strength: ",h.strength]}),(0,n.jsxs)("div",{children:["Critical: ",100*h.critical,"%"]}),(0,n.jsxs)("div",{children:["Power: ",h.power]}),(0,n.jsxs)("div",{children:["Rarity: ",h.rarity]})]})]})]})},j=e=>{let{isOpen:t,onClose:a,gameState:c,onSelectPickaxe:o}=e,l=t?"".concat(i().modal," ").concat(i().modalShow):i().modal,r=c.pickaxeInventory,m=r.currentItem,d=r.getCurrentItem(),[u,h]=(0,s.useState)(m),x=u?r.items.find(e=>e.id===u):d,k=e=>{console.log("handlePickaxePreview",e),h(e)};return(0,n.jsx)("div",{className:l,children:(0,n.jsxs)("div",{className:"".concat(i().modalContent," ").concat(i().shopModalContent),children:[(0,n.jsxs)("div",{className:i().modalHeader,children:[(0,n.jsx)("h2",{children:"Inventory"}),(0,n.jsx)("button",{className:i().closeBtn,onClick:a,children:"\xd7"})]}),(0,n.jsxs)("div",{className:i().inventorySection,children:[(0,n.jsx)("h3",{children:"Pickaxes"}),(0,n.jsx)("div",{className:i().pickaxeGrid,children:r.items.map(e=>(0,n.jsx)(g,{pickaxe:e,isSelected:e.id===u,onClick:k,showTooltip:!1},e.id))})]}),x&&(0,n.jsx)("div",{className:i().inventoryDetails,children:(0,n.jsxs)("div",{className:i().selectedItemDetails,children:[(0,n.jsxs)("h4",{children:[x.type," Pickaxe"]}),(0,n.jsxs)("p",{children:["Health: ",x.health," / ",x.getPickaxe().maxHealth]}),(0,n.jsxs)("p",{children:["Strength: ",x.getPickaxe().strength]}),u!==m&&(0,n.jsx)("button",{className:i().selectButton,onClick:()=>{u&&o&&(console.log("handlePickaxeSelect",u),o(u),a())},children:"Select Pickaxe"}),u===m&&(0,n.jsx)("div",{className:i().currentlyEquipped,children:"Currently Equipped"})]})})]})})},b=a(6335),N=e=>{let{isOpen:t,onClose:a,gameState:c,onUnlockBiome:o,onSelectBiome:l,selectionMode:r=!1}=e,d=b.a.items,h=c.unlockedBiomes,x=c.currentBiome.type,k=c.currentBiome.currentHealth<=0,p=(0,s.useRef)(null),[v,g]=(0,s.useState)(null);console.log("BiomesModal opened - Selection mode: ".concat(r,", Biome destroyed: ").concat(k,", Current health: ").concat(c.currentBiome.currentHealth)),(0,s.useEffect)(()=>{if(t&&p.current){let e=()=>{let e=p.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(i().hasScroll):e.classList.remove(i().hasScroll))};e();let t=new ResizeObserver(e);return t.observe(p.current),()=>{p.current&&t.unobserve(p.current),t.disconnect()}}},[t,d]);let j=e=>h.includes(e.toLowerCase()),N=e=>{o&&o(e.toLowerCase())},y=(e,t)=>{e.stopPropagation(),l&&j(t)&&t.toLowerCase()!==x&&(l(t.toLowerCase()),a())},f=e=>{if(j(e))return!0;let t=b.a.getItemByName(e);return!t.cost||c.blockInventory.hasBlock(t.cost.itemType,t.cost.amount)},C=(e,t)=>{e.stopPropagation(),g(t)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(i().biomesOverlay," ").concat(t?i().biomesOverlayOpen:""),onClick:a}),(0,n.jsxs)("div",{className:"".concat(i().biomesDrawer," ").concat(t?i().biomesDrawerOpen:""),children:[(0,n.jsx)("div",{className:i().biomesDrawerHandle,onClick:a}),(0,n.jsx)("div",{className:i().biomesDrawerHeader,children:(0,n.jsx)("h2",{children:r?"Select Biome":"Available Biomes"})}),(0,n.jsx)("div",{ref:p,className:i().biomesDrawerContent,"data-drawer-type":"biomes",children:(0,n.jsx)("div",{className:i().biomesSection,children:(0,n.jsx)("div",{className:i().biomesGrid,children:d.map(e=>{let t=j(e.name),a=f(e.name),s=e.name.toLowerCase()===x;return(0,n.jsxs)("div",{className:"".concat(i().biomeItem," \n                                                ").concat(t?i().biomeUnlocked:i().biomeLocked,"\n                                                ").concat(s?i().biomeSelected:""),children:[(0,n.jsxs)("div",{className:i().biomeImageContainer,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/biomes/".concat(e.name.toLowerCase(),".png")),alt:e.name,className:i().biomeItemImg}),!t&&(0,n.jsx)("div",{className:i().lockOverlay,children:(0,n.jsx)("img",{src:(0,m.K)("/assets/padlock.svg"),alt:"Locked",className:i().lockIcon})}),(0,n.jsxs)("div",{className:i().biomeNameOverlay,children:[e.name,t&&(0,n.jsx)("span",{className:i().unlockedIndicator,children:"✓"}),s&&(0,n.jsx)("span",{className:i().currentIndicator,children:" (Current)"})]})]}),(0,n.jsxs)("div",{className:i().availableBlocks,children:[(0,n.jsx)("span",{children:"Available Blocks:"}),(0,n.jsx)("div",{className:i().blockImagesContainer,children:e.availableBlocks.map(e=>(0,n.jsxs)("div",{className:i().blockImageWrapper,onClick:t=>C(t,e),style:{cursor:"pointer"},children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/blocks/".concat(e,".png")),alt:e,className:i().blockImage}),(0,n.jsx)("div",{className:i().blockName,children:e})]},e))})]}),(0,n.jsxs)("div",{className:i().availablePickaxes,children:[(0,n.jsx)("span",{children:"Available Pickaxes:"}),(0,n.jsx)("div",{className:i().blockImagesContainer,children:e.availablePickaxes.length>0?e.availablePickaxes.map(e=>(0,n.jsxs)("div",{className:i().blockImageWrapper,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/pickaxes/".concat(e,".png")),alt:e,className:i().blockImage}),(0,n.jsx)("div",{className:i().blockName,children:e})]},e)):(0,n.jsx)("div",{className:i().noPickaxes,children:"No pickaxes available"})})]}),(0,n.jsxs)("div",{className:i().itemInfo,children:[(0,n.jsx)("div",{className:i().itemDescription,children:e.description}),!t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:i().unlockCost,children:e.cost?(0,n.jsxs)(n.Fragment,{children:["Cost:",(0,n.jsxs)("div",{className:i().costItemContainer,children:[(0,n.jsxs)("div",{className:i().costItemImgWrapper,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/blocks/".concat(e.cost.itemType,".png")),alt:e.cost.itemType,className:i().costItemImg}),(0,n.jsx)("span",{className:i().costItemBadge,children:e.cost.amount})]}),(0,n.jsx)("span",{className:a?i().affordableCost:i().unaffordableCost,children:e.cost.itemType.replace(/_/g," ")})]})]}):(0,n.jsx)("span",{className:i().affordableCost,children:"Free"})}),(0,n.jsx)("button",{className:"".concat(i().unlockButton," ").concat(a?"":i().unlockButtonDisabled),onClick:()=>N(e.name),disabled:!a,children:a?"Unlock":"Not enough resources"})]}),t&&r&&!s&&(0,n.jsx)("button",{className:i().selectButton,onClick:t=>y(t,e.name),children:"Select"}),t&&r&&s&&(0,n.jsx)("div",{className:i().currentlyEquipped,children:"Currently Selected"})]})]},e.name)})})})})]}),(0,n.jsx)(u,{isOpen:null!==v,onClose:()=>{g(null)},blockName:v||""})]})},y=e=>{let{block:t,className:a="",showTooltip:c=!0}=e,[o,l]=(0,s.useState)(!1),r=t.getBlock();return(0,n.jsxs)("div",{className:"".concat(i().inventorySlot," ").concat(a),title:"".concat(t.name," - Quantity: ").concat(t.quantity),onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},children:[(0,n.jsx)("img",{src:t.getImageUrl(),alt:t.name,className:i().inventoryItem}),(0,n.jsx)("div",{className:i().itemCount,children:t.quantity}),c&&o&&(0,n.jsxs)("div",{className:i().quickItemTooltip,children:[(0,n.jsx)("div",{className:i().quickItemName,children:t.name.charAt(0).toUpperCase()+t.name.slice(1)}),(0,n.jsxs)("div",{className:i().quickItemStats,children:[(0,n.jsxs)("div",{children:["Quantity: ",t.quantity]}),(0,n.jsxs)("div",{children:["Rarity: ",r.rarity]})]})]})]})};function f(e){let{items:t,totalSlots:a,itemType:s,renderItem:c,renderEmptySlot:o}=e,l=[],r=t.length,m=Math.max(1,Math.ceil(r/a));for(let e=0;e<m;e++){let m=Array(a).fill(null);for(let n=0;n<a;n++){let s=e*a+n;s<r&&(m[n]=t[s])}l.push((0,n.jsx)("div",{className:i().quickInventory,children:m.map((t,a)=>t?c(t,e,a):o(e,a))},"".concat(s,"-row-").concat(e)))}return(0,n.jsx)(n.Fragment,{children:l})}var C=e=>{let{gameState:t,onSelectPickaxe:a}=e,s=t.pickaxeInventory,c=t.blockInventory,o=s.currentItem,l=e=>{a&&e&&a(e)};return(0,n.jsxs)("div",{className:i().quickInventoryContainer,children:[(0,n.jsxs)("div",{className:i().quickInventorySection,children:[(0,n.jsx)("div",{className:i().quickInventoryLabel,children:"Pickaxes"}),(0,n.jsx)(f,{items:s.items,totalSlots:8,itemType:"pickaxe",renderItem:(e,t,a)=>(0,n.jsx)(g,{pickaxe:e,isSelected:e.id===o,onClick:l},e.id),renderEmptySlot:(e,t)=>(0,n.jsx)("div",{className:i().inventorySlot},"pickaxe-empty-".concat(e,"-").concat(t))})]}),(0,n.jsxs)("div",{className:i().quickInventorySection,children:[(0,n.jsx)("div",{className:i().quickInventoryLabel,children:"Blocks"}),(0,n.jsx)(f,{items:c.items,totalSlots:8,itemType:"block",renderItem:(e,t,a)=>(0,n.jsx)(y,{block:e},"block-".concat(e.name,"-").concat(t,"-").concat(a)),renderEmptySlot:(e,t)=>(0,n.jsx)("div",{className:i().inventorySlot},"block-empty-".concat(e,"-").concat(t))})]})]})},I=a(7390),B=a(1499);class S{toggleSound(e){this.soundEnabled=e}preloadSound(e,t){try{let a=new Audio(t);this.sounds.set(e,a)}catch(t){console.error("Error loading sound ".concat(e,": ").concat(t))}}playSound(e){if(this.soundEnabled)try{let t=this.sounds.get(e);t?(t.currentTime=0,t.play().catch(t=>{console.error("Error playing sound ".concat(e,": ").concat(t))})):console.warn('Sound "'.concat(e,'" not found'))}catch(t){console.error("Error playing sound ".concat(e,": ").concat(t))}}constructor(){this.sounds=new Map,this.soundEnabled=!0,this.preloadSound("error","/assets/sounds/error.mp3")}}let w=new S;var P=a(224);let D=e=>{switch(e){case"Common":default:return 100;case"Uncommon":return 200;case"Rare":return 500;case"Legendary":return 2e3}},_=e=>{switch(e){case"Common":default:return"#aaaaaa";case"Uncommon":return"#55ff55";case"Rare":return"#5555ff";case"Legendary":return"#ffaa00"}};var O=e=>{let{isOpen:t,onClose:a,gameState:c,onBuyBlock:o}=e,l=c.currentBiome.getBiome(),r=l.availableBlocks||[],m=(0,s.useRef)(null),[h,x]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(t&&m.current){let e=()=>{let e=m.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(i().hasScroll):e.classList.remove(i().hasScroll))};e();let t=new ResizeObserver(e);return t.observe(m.current),()=>{m.current&&t.unobserve(m.current),t.disconnect()}}},[t,r]);let k=e=>{x(e)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(i().biomesOverlay," ").concat(t?i().biomesOverlayOpen:""),onClick:a}),(0,n.jsxs)("div",{className:"".concat(i().biomesDrawer," ").concat(t?i().biomesDrawerOpen:""),children:[(0,n.jsx)("div",{className:i().biomesDrawerHandle,onClick:a}),(0,n.jsx)("div",{className:i().biomesDrawerHeader,children:(0,n.jsxs)("h2",{children:["Buy Blocks from ",l.name," biome"]})}),(0,n.jsx)("div",{ref:m,className:i().biomesDrawerContent,"data-drawer-type":"blocks",children:(0,n.jsxs)("div",{className:i().biomesSection,children:[(0,n.jsxs)("p",{children:["Your picks: ",c.picks]}),0===r.length?(0,n.jsx)("p",{children:"No blocks available in this biome."}):(0,n.jsx)("div",{className:i().blocksGrid,children:r.map(e=>{let t=new d.f({name:e,quantity:1}),a=t.getImageUrl(),s=t.getBlock().rarity,r=D(s),m=c.picks>=r,u=_(s);return(0,n.jsxs)("div",{className:i().blockItem,onClick:()=>k(e),style:{cursor:"pointer"},children:[(0,n.jsxs)("div",{className:i().blockImageContainer,children:[(0,n.jsx)("img",{src:a,alt:e,className:i().blockItemImg}),(0,n.jsx)("div",{className:i().blockNameOverlay,children:e}),(0,n.jsx)("div",{className:i().rarityBadge,style:{backgroundColor:u},children:s})]}),(0,n.jsxs)("div",{className:i().blockItemContent,children:[(0,n.jsxs)("div",{className:i().blockDescription,children:["A ",s.toLowerCase()," ",e," block from the ",l.name," biome."]}),(0,n.jsx)("button",{className:"".concat(i().buyBlockButton," ").concat(m?"":i().buyBlockButtonDisabled),onClick:t=>{t.stopPropagation(),m&&o(e)},disabled:!m,children:m?"Buy (".concat(r," picks)"):"Need ".concat(r," picks")})]})]},e)})})]})})]}),(0,n.jsx)(u,{isOpen:null!==h,onClose:()=>{x(null)},blockName:h||""})]})},T=e=>{let{isOpen:t,onClose:a,gameState:c}=e,[o,l]=(0,s.useState)(!1);if(!t)return null;let r=I.ZP.exportGameState(c);return(0,n.jsx)("div",{className:i().modal+" "+i().modalShow,children:(0,n.jsxs)("div",{className:i().modalContent,children:[(0,n.jsxs)("div",{className:i().modalHeader,children:[(0,n.jsx)("h2",{children:"Export Game Save"}),(0,n.jsx)("button",{className:i().closeBtn,onClick:a,children:"\xd7"})]}),(0,n.jsxs)("div",{className:i().modalBody,children:[(0,n.jsx)("p",{children:"Copy the code below or download it as a file to save your current game progress:"}),(0,n.jsx)("div",{className:i().exportCodeContainer,children:(0,n.jsx)("textarea",{className:i().exportCode,value:r,readOnly:!0,rows:6})}),(0,n.jsxs)("div",{className:i().exportActions,children:[(0,n.jsx)("button",{className:i().exportActionButton,onClick:()=>{navigator.clipboard.writeText(r),l(!0),setTimeout(()=>l(!1),2e3)},children:o?"Copied!":"Copy to Clipboard"}),(0,n.jsx)("button",{className:i().exportActionButton,onClick:()=>{let e=document.createElement("a"),t=new Blob([r],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download="mathcrafter-save-".concat(Date.now(),".txt"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},children:"Download as File"})]})]})]})})},M=a(1517),H=a(7154);class L extends H.y{constructor(e){super(e)}}let E=new L([{name:"circadian_dust",ingredients:[{item:"dawn_stone",amount:1},{item:"dusk_stone",amount:1}]},{name:"refined_waste",ingredients:[{item:"diluted_waste",amount:1},{item:"nuclear_waste",amount:1}]},{name:"enchanted_book",ingredients:[{item:"book",amount:1},{item:"lapis_lazuli",amount:5}]},{name:"magic_book",ingredients:[{item:"cursed_book",amount:1},{item:"enchanted_book",amount:1}]},{name:"qbit",ingredients:[{item:"tritium",amount:3},{item:"hydrogen",amount:1},{item:"plasma",amount:1}]},{name:"rocket_fuel",ingredients:[{item:"enderium",amount:1},{item:"amethyst",amount:1},{item:"endstone",amount:10}]},{name:"dyson_sphere_part",ingredients:[{item:"quantum_chip",amount:1},{item:"hydrogen",amount:1},{item:"tritium",amount:1},{item:"plasma",amount:10}]},{name:"quantum_chip",ingredients:[{item:"qbit",amount:3},{item:"hydrogen",amount:1}]},{name:"time_key_fragment",ingredients:[{item:"plasma",amount:5},{item:"star_core",amount:5},{item:"tritium",amount:1}]},{name:"time_key",ingredients:[{item:"time_key_fragment",amount:100}]},{name:"time_key_fragment",ingredients:[{item:"time_key_fragment",amount:100}]},{name:"circuit_board",ingredients:[{item:"clock_gear",amount:5},{item:"clock_spring",amount:1},{item:"time_stone",amount:1}]},{name:"graviton",ingredients:[{item:"tritium",amount:1},{item:"clock_spring",amount:1},{item:"secret_of_time",amount:1},{item:"sand_of_clock",amount:4}]},{name:"off_bit",ingredients:[{item:"bool",amount:1}]},{name:"on_bit",ingredients:[{item:"bool",amount:2}]},{name:"c_sharp",ingredients:[{item:"on_bit",amount:1},{item:"off_bit",amount:1},{item:"struct",amount:1}]}]);function R(e,t){return!!e&&!!e.ingredients&&!!t&&e.ingredients.every(e=>t.getBlockQuantity(e.item)>=e.amount)}var q=e=>{let{isOpen:t,onClose:a,gameState:c,onCraft:o}=e,[l,r]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),[h,x]=(0,s.useState)(null),k=e=>{r(e),u(!1),x(null)},p=e=>(0,m.K)("/assets/blocks/".concat(e,".png")),v=e=>R(e,c.blockInventory),g=e=>{let t=v(e),a=p(e.name);return(0,n.jsxs)("div",{className:"".concat(i().recipeCard," ").concat(t?i().selectableRecipe:i().unavailableRecipe),onClick:()=>k(e),children:[(0,n.jsxs)("div",{className:i().recipeOutput,children:[(0,n.jsx)("img",{src:a,alt:e.name,className:i().recipeImage}),(0,n.jsx)("div",{className:i().recipeName,children:e.name.replace(/_/g," ")})]}),(0,n.jsx)("div",{className:i().recipeIngredients,children:e.ingredients.map((t,a)=>{let s=p(t.item),o=c.blockInventory.getBlockQuantity(t.item),l=o>=t.amount;return(0,n.jsxs)("div",{className:"".concat(i().ingredientItem," ").concat(l?"":i().missingIngredient),children:[(0,n.jsx)("img",{src:s,alt:t.item,className:i().ingredientImage}),(0,n.jsxs)("div",{className:i().ingredientDetails,children:[(0,n.jsx)("div",{className:i().ingredientName,children:t.item.replace(/_/g," ")}),(0,n.jsxs)("div",{className:i().ingredientAmount,children:[o,"/",t.amount]})]})]},"".concat(e.name,"-").concat(t.item,"-").concat(a))})})]},e.name)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(i().biomesOverlay," ").concat(t?i().biomesOverlayOpen:""),onClick:a}),(0,n.jsxs)("div",{className:"".concat(i().biomesDrawer," ").concat(t?i().biomesDrawerOpen:""),children:[(0,n.jsx)("div",{className:i().biomesDrawerHandle,onClick:a}),(0,n.jsx)("div",{className:i().biomesDrawerHeader,children:(0,n.jsx)("h2",{children:"Furnace Recipes"})}),(0,n.jsxs)("div",{className:i().biomesDrawerContent,"data-drawer-type":"furnace",children:[d&&h&&(0,n.jsxs)("div",{className:i().craftingSuccess,children:[(0,n.jsx)("img",{src:p(h),alt:h,className:i().craftedItemImage}),(0,n.jsxs)("div",{className:i().craftedItemText,children:["Successfully crafted ",h.replace(/_/g," "),"!"]})]}),(0,n.jsx)("div",{className:i().recipesContainer,children:E.items.map(e=>g(e))})]})]}),l&&(0,n.jsx)("div",{className:i().recipeDetailsOverlay,onClick:()=>r(null),children:(0,n.jsxs)("div",{className:i().recipeDetailsContainer,onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:i().recipeDetailsHeader,children:[(0,n.jsxs)("h3",{children:["Craft ",l.name.replace(/_/g," ")]}),(0,n.jsx)("button",{className:i().closeBtn,onClick:()=>r(null),children:"\xd7"})]}),(0,n.jsxs)("div",{className:i().recipeDetailsContent,children:[(0,n.jsxs)("div",{className:i().recipeOutputDetails,children:[(0,n.jsx)("img",{src:p(l.name),alt:l.name,className:i().recipeOutputImage}),(0,n.jsx)("div",{className:i().recipeOutputName,children:l.name.replace(/_/g," ")})]}),(0,n.jsxs)("div",{className:i().recipeIngredientsList,children:[(0,n.jsx)("h4",{children:"Required Ingredients:"}),l.ingredients.map((e,t)=>{let a=c.blockInventory.getBlockQuantity(e.item),s=a>=e.amount;return(0,n.jsxs)("div",{className:"".concat(i().recipeIngredientDetail," ").concat(s?"":i().missingIngredientDetail),children:[(0,n.jsx)("img",{src:p(e.item),alt:e.item,className:i().ingredientDetailImage}),(0,n.jsxs)("div",{className:i().ingredientDetailInfo,children:[(0,n.jsx)("div",{className:i().ingredientDetailName,children:e.item.replace(/_/g," ")}),(0,n.jsxs)("div",{className:i().ingredientDetailAmount,children:[a,"/",e.amount]})]})]},"detail-".concat(l.name,"-").concat(e.item,"-").concat(t))})]}),(0,n.jsx)("button",{className:"".concat(i().craftButton," ").concat(v(l)?"":i().craftButtonDisabled),disabled:!v(l),onClick:()=>{l&&v(l)&&(!function(e,t){if(!R(e,t.blockInventory))return console.error("Cannot craft recipe - missing ingredients");let a=t;e.ingredients.forEach(e=>{a=a.withBlockInventory(a.blockInventory.addBlock(e.item,-e.amount))}),a=a.withBlockInventory(a.blockInventory.addBlock(e.name,1)),console.log("Crafted ".concat(e.name," successfully"))}(l,c),o&&o(l),u(!0),x(l.name),setTimeout(()=>{r(null),u(!1)},2e3))},children:v(l)?"Craft Item":"Missing Ingredients"})]})]})})]})},U=()=>{let[e,t]=(0,s.useState)(!1),[a,c]=(0,s.useState)(I.ZP.loadGameState()),[u,h]=(0,s.useState)({num1:0,num2:0,operator:"+",answer:0}),[x,g]=(0,s.useState)(""),[y,f]=(0,s.useState)(!1),[S,D]=(0,s.useState)(!1),[_,H]=(0,s.useState)(!1),[L,E]=(0,s.useState)(!1),[R,U]=(0,s.useState)(!1),[A,F]=(0,s.useState)(!1),[G,K]=(0,s.useState)(""),[z,Z]=(0,s.useState)(!1),[Q,Y]=(0,s.useState)(""),[W,X]=(0,s.useState)(!1),[V,J]=(0,s.useState)(!1),[$,ee]=(0,s.useState)(null),[et,ea]=(0,s.useState)(null),[en,es]=(0,s.useState)(null),[ec,ei]=(0,s.useState)(!1),[eo,el]=(0,s.useState)(!1),[er,em]=(0,s.useState)(!1),[ed,eu]=(0,s.useState)(!1),[eh,ex]=(0,s.useState)(!1),[ek,ep]=(0,s.useState)(!1),ev=(0,s.useRef)(null);(0,s.useEffect)(()=>{t(!0),h(I.ZP.generateMathProblem()),c(I.ZP.loadGameState())},[]),(0,s.useEffect)(()=>{e&&!y&&I.ZP.saveGameState(a)},[a,e,y]),(0,s.useEffect)(()=>{console.log("gameState",a);let e=a.currentBiome;e.currentHealth<=0&&(console.log("Biome destroyed! Opening selection modal..."),Y(e.type),Z(!0),setTimeout(()=>{Z(!1)},3e3))},[a]),(0,s.useEffect)(()=>{R&&ev.current&&setTimeout(()=>{var e;null===(e=ev.current)||void 0===e||e.focus()},100)},[R]);let eg=()=>{h(I.ZP.generateMathProblem()),g(""),eu(!1)},ej=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=a.pickaxeInventory.getCurrentItem();if(!n){console.error("No current pickaxe found");return}ee(e=e||n.getPicks()),setTimeout(()=>{ee(null)},2e3),eb(),c(a=>{let n=a.pickaxeInventory.getCurrentItem();if(!n)return console.log("No current pickaxe found"),a;let s=a.increasePicks(e||0);if(t){let e=a.currentBiome.withDamage(n.getDamageToBiome(a.currentBiome.getBiome()));return console.log("Biome health: ".concat(e.currentHealth,"/").concat(e.getBiome().maxHealth)),s.withCurrentBiome(e)}return a})},eb=()=>{if(!a.pickaxeInventory.getCurrentItem())return;let e=a.currentBiome;if(!e)return;let t=e.getBiome().availableBlocks,n={Common:[],Uncommon:[],Rare:[],Legendary:[]},s={Common:.55,Uncommon:.3,Rare:.1,Legendary:.05};t.forEach(e=>{let t=M.Z.getItemByName(e);if(null===t){console.error("Block with name ".concat(e," not found"));return}n[t.rarity].push(t)});let c=Object.keys(s).find(e=>Math.random()<=s[e]);if(!c){console.error("No rarity found");return}let i=Math.floor(Math.random()*n[c].length),o=n[c][i];if(!o){console.error("No block found");return}eN(o.name)},eN=e=>{let t=new d.f({name:e,quantity:1});ea({name:e,imageUrl:t.getImageUrl()}),es(t),setTimeout(()=>{es(null)},3e3),c(t=>{let a=t.blockInventory.addBlock(e,1);return t.withBlockInventory(a)})},ey=()=>{X(!0),J(!0),w.playSound("error"),document.body.classList.add("screen-shake"),setTimeout(()=>{J(!1)},1e3),setTimeout(()=>{X(!1),document.body.classList.remove("screen-shake")},500),c(e=>{let t=e.pickaxeInventory.getCurrentItem();if(null===t)return e;let a=t.withDamage(1),n=new B.t({id:a.id,type:a.type,health:a.health});if(n.health<=0)return ef(e);let s=e.pickaxeInventory.withCurrentItem(n);return e.withPickaxeInventory(s)})},ef=e=>{let t=e.pickaxeInventory.getCurrentItem();if(!t)return e;if(K(t.type),F(!0),setTimeout(()=>{F(!1)},3e3),e.pickaxeInventory.length<=1)return f(!0),e;let a=e.pickaxeInventory.removeCurrentItem();return e.withPickaxeInventory(a)},eC=()=>{D(e=>!e)},eI=()=>{H(e=>!e)},eB=()=>{E(e=>!e)},eS=()=>{ei(e=>!e)},ew=()=>{el(e=>!e)},eP=()=>{em(e=>!e)},eD=e=>{if(!a.pickaxeInventory.items.find(t=>t.id===e)){console.error("Selected pickaxe not found in inventory");return}let t=a.pickaxeInventory.withCurrentItemId(e);c(e=>{let a=e.withPickaxeInventory(t);return setTimeout(()=>{I.ZP.saveGameState(a)},0),a}),H(!1)},e_=e=>{switch(e){case"Common":default:return 100;case"Uncommon":return 200;case"Rare":return 500;case"Legendary":return 2e3}};return(a.pickaxeInventory.length,e)?(0,n.jsxs)("div",{className:i().gameContainer,children:[(0,n.jsxs)("div",{className:i().gameHeader,children:[(0,n.jsx)("h1",{children:"MathCrafter"}),(0,n.jsx)("div",{className:i().avatar,children:(0,n.jsx)("img",{src:(0,m.K)("/assets/avatars/avatar.png"),alt:"Player Avatar",className:i().avatarImage,onClick:eI,style:{cursor:"pointer"}})}),(0,n.jsx)("div",{className:i().stats,children:(0,n.jsxs)("div",{className:i().statItem,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/picks.png"),alt:"Picks",className:i().picksIcon}),(0,n.jsx)("span",{children:a.picks})]})}),(0,n.jsxs)("div",{className:i().headerButtons,children:[(0,n.jsx)("button",{className:i().pickaxesButton,onClick:eC,children:"Pickaxes"}),(0,n.jsx)("button",{className:i().unlockBiomesButton,onClick:eB,children:"Biomes"}),(0,n.jsx)("button",{className:i().buyBlocksButton,onClick:eS,children:"Blocks"}),(0,n.jsx)("button",{className:i().furnaceButton,onClick:eP,children:"Furnace"}),(0,n.jsx)("button",{className:i().exportGameButton,onClick:ew,children:"Export"})]})]}),(0,n.jsxs)("div",{className:i().gameArea,children:[(0,n.jsx)(v,{onBiomeClick:()=>{if(R)return;let e=a.pickaxeInventory.getCurrentItem();e&&(Math.random()<=e.getPickaxe().critical?(U(!0),eg()):ej(e.getPickaxe().strength,!0))},currentPickaxe:a.pickaxeInventory.getCurrentItem(),currentBiome:a.currentBiome,picksToShow:$,minedBlock:et}),(0,n.jsx)(C,{gameState:a,onSelectPickaxe:eD})]}),(0,n.jsx)("div",{className:"".concat(i().modal," ").concat(R?i().modalShow:""),children:(0,n.jsxs)("div",{className:"".concat(i().modalContent," ").concat(i().questionModalContent),children:[(0,n.jsxs)("div",{className:i().modalHeader,children:[(0,n.jsx)("h2",{children:"Math Problem"}),(0,n.jsx)("button",{className:i().closeBtn,onClick:()=>{U(!1)},children:"\xd7"})]}),(0,n.jsxs)("form",{className:"".concat(i().mathProblem," ").concat(W?i().wrongAnswerShake+" "+i().wrongAnswerFlash:""),onSubmit:e=>{e.preventDefault();let t=parseInt(x);isNaN(t)||(t===u.answer?(ej(null,!0),eg(),g(""),U(!1)):(ey(),g("")))},children:[(0,n.jsxs)("div",{className:i().question,children:[u.num1," ",u.operator," ",u.num2," = ?"]}),eh&&(0,n.jsx)("div",{className:i().notEnoughPicks,children:"Not enough picks! Need 500 picks for a hint."}),(0,n.jsxs)("div",{className:i().answerArea,children:[(0,n.jsx)("input",{ref:ev,type:"number",className:"".concat(i().answer," ").concat(ek?i().hintAnswer:""),value:x,onChange:e=>g(e.target.value),readOnly:ek,autoFocus:!0}),(0,n.jsx)("div",{className:i().buttonGroup,children:(0,n.jsx)("button",{type:"submit",className:i().submitBtn,children:"Mine!"})})]}),(0,n.jsxs)("div",{className:i().numpad,children:[[7,8,9,4,5,6,1,2,3,0].map(e=>(0,n.jsx)("button",{type:"button",className:i().numpadBtn,onClick:()=>g(t=>t+e.toString()),children:e},e)),(0,n.jsxs)("button",{type:"button",className:"".concat(i().numpadBtn," ").concat(i().hintBtn," ").concat(a.picks<500?i().hintBtnDisabled:""),onClick:()=>{if(a.picks<500){ex(!0),setTimeout(()=>{ex(!1)},2e3);return}c(e=>e.increasePicks(-500)),eu(!0),ep(!0),g(u.answer.toString()),setTimeout(()=>{var e;ep(!1),g(""),null===(e=ev.current)||void 0===e||e.focus()},2e3)},disabled:a.picks<500,children:["Hint (",500,")"]}),(0,n.jsx)("button",{type:"button",className:"".concat(i().numpadBtn," ").concat(i().clearBtn),onClick:()=>g(""),children:"Clear"}),(0,n.jsx)("button",{type:"button",className:"".concat(i().numpadBtn," ").concat(i().deleteBtn),onClick:()=>g(e=>e.slice(0,-1)),children:"←"})]})]})]})}),V&&(0,n.jsx)("div",{className:i().incorrectText,children:"INCORRECT!"}),(0,n.jsx)(k,{isOpen:S,onClose:eC,gameState:a,onBuyItem:(e,t)=>{let n=r.o.getItemByName(e);if(!n){console.error("Pickaxe with name ".concat(e," not found"));return}let s=n.cost.itemType,i=n.cost.amount;if(!a.blockInventory.hasBlock(s,i)){console.error("Not enough ".concat(s," to craft ").concat(e," pickaxe"));return}let o=new B.t({id:null,type:e,health:null}),l=a.blockInventory;l=l.addBlock(s,-i);let m=new P.C0({items:[...a.pickaxeInventory.items,o],currentItem:o.id});c(a.withPickaxeInventory(m).withBlockInventory(l))}}),(0,n.jsx)(j,{isOpen:_,onClose:eI,gameState:a,onSelectPickaxe:eD}),(0,n.jsx)(N,{isOpen:L,onClose:eB,gameState:a,onUnlockBiome:e=>{if(a.unlockedBiomes.includes(e))return;let t=b.a.getItemByName(e);if(!t){console.error("Biome with name ".concat(e," not found"));return}if(t.cost){let n=t.cost.itemType,s=t.cost.amount;if(!a.blockInventory.hasBlock(n,s)){console.error("Not enough ".concat(n," to unlock ").concat(e," biome"));return}c(t=>{let a=t.blockInventory;a=a.addBlock(n,-s);let c=[...t.unlockedBiomes,e];return new o.D({...t,unlockedBiomes:c,blockInventory:a})})}else c(t=>{let a=[...t.unlockedBiomes,e];return new o.D({...t,unlockedBiomes:a})})},onSelectBiome:e=>{c(t=>{let a=new l.k({id:null,type:e,currentHealth:null});return t.withCurrentBiome(a)})},selectionMode:!0}),(0,n.jsx)(O,{isOpen:ec,onClose:eS,gameState:a,onBuyBlock:e=>{console.log("handleBuyBlock",e);let t=M.Z.getItemByName(e);if(t){let n=e_(t.rarity);a.picks>=n&&(c(a.increasePicks(-n).withBlockInventory(a.blockInventory.addBlock(e,1))),w.playSound("buy"))}}}),(0,n.jsx)(T,{isOpen:eo,onClose:ew,gameState:a}),(0,n.jsx)(q,{isOpen:er,onClose:eP,gameState:a,onCraft:e=>{console.log("handleCraftRecipe",e),w.playSound("craft"),es(new d.f({name:e.name,quantity:1})),setTimeout(()=>{es(null)},2e3),c(e=>new o.D({pickaxeInventory:e.pickaxeInventory,blockInventory:e.blockInventory,picks:e.picks,unlockedBiomes:e.unlockedBiomes,currentBiome:e.currentBiome}))}}),(0,n.jsx)(p,{isOpen:y,onRestart:()=>{let e=I.ZP.loadGameState();c(e),f(!1),U(!1),eg(),I.ZP.saveGameState(e)}}),A&&(0,n.jsxs)("div",{className:i().brokenPickaxeNotification,children:[(0,n.jsx)("h3",{children:"Pickaxe Destroyed!"}),(0,n.jsxs)("p",{children:["Your ",G," Pickaxe has broken."]})]}),z&&(0,n.jsxs)("div",{className:i().biomeDestroyedNotification,children:[(0,n.jsx)("h3",{children:"Biome Conquered!"}),(0,n.jsxs)("p",{children:["You've mined the ",Q," biome."]}),(0,n.jsx)("p",{children:"Please select a new biome to explore!"})]}),en&&(0,n.jsxs)("div",{className:i().blockAddedNotification,children:[(0,n.jsx)("img",{src:en.getImageUrl(),alt:en.name}),(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:["+1 ",en.name]})})]})]}):(0,n.jsx)("div",{className:i().gameContainer,children:"Loading..."})}}}]);