(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{7661:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return P}});var n=t(5893),s=t(7294),c=t(6784),o=t.n(c),l=t(1485),i=t(8751),r=t(640),m=t(2627);let d=e=>{switch(e){case"Common":default:return"#aaaaaa";case"Uncommon":return"#55ff55";case"Rare":return"#5555ff";case"Epic":return"#aa00aa";case"Seasonal":return"#ff5555";case"Legendary":return"#ffaa00"}};var _=e=>{let{isOpen:a,onClose:t,gameState:c,onBuyItem:l}=e,[i,_]=(0,s.useState)(!0),u=(0,s.useRef)(null),h=r.o.items,k=i?h.filter(e=>c.currentBiome.getBiome().availablePickaxes.includes(e.name.toLowerCase())):h;(0,s.useEffect)(()=>{if(a&&u.current){let e=()=>{let e=u.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(o().hasScroll):e.classList.remove(o().hasScroll))};e();let a=new ResizeObserver(e);return a.observe(u.current),()=>{u.current&&a.unobserve(u.current),a.disconnect()}}},[a,k]);let x=(e,a)=>c.blockInventory.hasBlock(e,a),v=e=>{let{itemType:a,amount:t}=e.cost,n=c.blockInventory.getBlockQuantity(a);return n<t?"Need ".concat(t-n," more ").concat(a):"Buy (".concat(t," ").concat(a,")")};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(o().biomesOverlay," ").concat(a?o().biomesOverlayOpen:""),onClick:t}),(0,n.jsxs)("div",{className:"".concat(o().biomesDrawer," ").concat(a?o().biomesDrawerOpen:""),children:[(0,n.jsx)("div",{className:o().biomesDrawerHandle,onClick:t}),(0,n.jsxs)("div",{className:o().biomesDrawerHeader,children:[(0,n.jsx)("h2",{children:"Shop Pickaxes"}),(0,n.jsxs)("div",{className:o().toggleContainer,children:[(0,n.jsxs)("label",{className:o().toggleSwitch,children:[(0,n.jsx)("input",{type:"checkbox",checked:i,onChange:()=>{_(e=>!e)}}),(0,n.jsx)("span",{className:o().toggleSlider})]}),(0,n.jsx)("span",{className:o().toggleLabel,children:i?"Showing biome pickaxes only":"Showing all pickaxes"})]})]}),(0,n.jsx)("div",{ref:u,className:o().biomesDrawerContent,"data-drawer-type":"pickaxes",children:(0,n.jsx)("div",{className:o().biomesSection,children:(0,n.jsx)("div",{className:o().pickaxesGrid,children:k.map(e=>{let a=x(e.cost.itemType,e.cost.amount),t=d(e.rarity);return(0,n.jsxs)("div",{className:o().pickaxeItem,children:[(0,n.jsxs)("div",{className:o().pickaxeImageContainer,children:[(0,n.jsx)("img",{src:"".concat((0,m.K)("/assets/pickaxes/".concat(e.name.toLowerCase(),".png"))),alt:"".concat(e.name," Pickaxe"),className:o().pickaxeItemImg}),(0,n.jsx)("div",{className:o().rarityBadge,style:{backgroundColor:t,top:"auto",bottom:"5px"},children:e.rarity})]}),(0,n.jsxs)("div",{className:o().pickaxeItemContent,children:[(0,n.jsxs)("div",{className:o().pickaxeInfo,children:[(0,n.jsxs)("div",{className:o().itemName,children:[e.name.charAt(0).toUpperCase()+e.name.slice(1)," Pickaxe"]}),(0,n.jsxs)("div",{className:o().itemDescription,children:["Strength: ",e.strength," | Durability: ",e.maxHealth," | Crit: ",100*e.critical,"%"]}),(0,n.jsxs)("div",{className:o().unlockCost,children:["Cost: ",(0,n.jsxs)("span",{className:a?o().affordableCost:o().unaffordableCost,children:[e.cost.amount," ",e.cost.itemType]}),(0,n.jsxs)("div",{children:["(You have: ",c.blockInventory.getBlockQuantity(e.cost.itemType),")"]})]})]}),(0,n.jsx)("button",{className:"".concat(o().buyPickaxeButton," ").concat(a?"":o().buyPickaxeButtonDisabled),onClick:()=>l(e.name,0),disabled:!a,children:v(e)})]})]},e.name)})})})})]})]})},u=e=>{let{isOpen:a,onRestart:t}=e;return(0,n.jsx)("div",{className:"".concat(o().modal," ").concat(a?o().modalShow:""),children:(0,n.jsxs)("div",{className:o().modalContent,children:[(0,n.jsx)("h2",{children:"Game Over!"}),(0,n.jsx)("p",{children:"You've lost all your pickaxes!"}),(0,n.jsx)("button",{className:o().restartBtn,onClick:t,children:"Play Again"})]})})},h=e=>{let{onBiomeClick:a,currentPickaxe:t,currentBiome:c,picksToShow:l,minedBlock:i}=e,[r,d]=(0,s.useState)({x:0,y:0}),[_,u]=(0,s.useState)(!1),[h,k]=(0,s.useState)((null==c?void 0:c.currentHealth)||0),[x,v]=(0,s.useState)((0,m.K)("/assets/pickaxes/wood.webp")),[b,p]=(0,s.useState)(!1),[g,y]=(0,s.useState)(null),[I,j]=(0,s.useState)(!1),[N,G]=(0,s.useState)(null),B=(0,s.useRef)(null);(0,s.useEffect)(()=>{t&&v(t.getImageUrl())},[t]),(0,s.useEffect)(()=>{if(l){y(l),p(!0);let e=setTimeout(()=>{p(!1)},1500);return()=>clearTimeout(e)}},[l]),(0,s.useEffect)(()=>{if(i){G(i),j(!0);let e=setTimeout(()=>{j(!1)},1500);return()=>clearTimeout(e)}},[i]),(0,s.useEffect)(()=>{let e=(null==c?void 0:c.currentHealth)||0;if(e<h&&B.current){let e=B.current;e.classList.add(o().shake),setTimeout(()=>{e.classList.remove(o().shake)},500)}k(e)},[null==c?void 0:c.currentHealth,h]);let C=()=>{u(!0),setTimeout(()=>u(!1),300)},f=(null==c?void 0:c.damagePercent)||100;return(0,n.jsxs)("div",{className:o().biomeContainer,children:[(0,n.jsxs)("div",{ref:B,className:"".concat(o().biome),onMouseMove:e=>{if(B.current){let a=B.current.getBoundingClientRect();d({x:e.clientX-a.left,y:e.clientY-a.top})}},onClick:()=>{a(),C()},style:{backgroundImage:"url(".concat(null==c?void 0:c.getImageUrl(),")"),backgroundSize:"cover",backgroundPosition:"center"},children:[b&&g&&(0,n.jsxs)("div",{className:o().scoreFlash,children:["+",g]}),I&&N&&(0,n.jsx)("div",{className:o().minedBlock,style:{top:"50%",left:"50%",backgroundImage:"url(".concat(N.imageUrl,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),f<100&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:o().crackOverlay,style:{opacity:Math.max(.2,1-f/100),backgroundImage:"url(".concat((0,m.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(1+(1-f/100),")"),filter:"contrast(".concat(100+(100-f),"%) brightness(").concat(100+(100-f)/2,"%)")}}),f<50&&(0,n.jsx)("div",{className:"".concat(o().crackOverlay," ").concat(o().secondaryCracks),style:{opacity:Math.max(.1,.8-f/50),backgroundImage:"url(".concat((0,m.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(.7+(1-f/50),") rotate(45deg)")}}),f<25&&(0,n.jsx)("div",{className:"".concat(o().crackOverlay," ").concat(o().criticalCracks),style:{opacity:Math.max(.15,.9-f/25),backgroundImage:"url(".concat((0,m.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(.9+(1-f/25),") rotate(-30deg)")}})]}),(0,n.jsx)("div",{className:o().pickaxeCursor,style:{left:"".concat(r.x,"px"),top:"".concat(r.y,"px")},children:(0,n.jsx)("img",{src:x,alt:"Pickaxe cursor",className:_?o().swingAnimation:""})})]}),(0,n.jsxs)("div",{className:o().horizontalHealthContainer,children:[(0,n.jsx)("div",{className:o().horizontalHealthBar,style:{width:"".concat(f,"%"),backgroundColor:f>60?"#72CB3B":f>30?"#FFCC00":"#FF6B6B"}}),(0,n.jsxs)("div",{className:o().horizontalHealthText,children:[Math.ceil(f),"%"]})]})]})},k=e=>{let{pickaxe:a,isSelected:t,onClick:c,className:l="",showTooltip:i=!0}=e,[r,m]=(0,s.useState)(!1),d=a.getPickaxe().maxHealth,_=a.health/d*100,u=a.getPickaxe(),h=_<=50?"rgb(".concat(255,", ").concat(Math.round(59+_/50*158),", ").concat(Math.round(59+-(_/50*59)),")"):"rgb(".concat(Math.round(255-(_-50)/50*141),", ").concat(Math.round(217-(_-50)/50*14),", ").concat(Math.round(0+(_-50)/50*59),")");return(0,n.jsxs)("div",{className:"".concat(o().inventorySlot," ").concat(t?o().selected:""," ").concat(l),onClick:()=>{c(a.id)},onMouseEnter:()=>{m(!0)},onMouseLeave:()=>{m(!1)},title:"".concat(a.type," Pickaxe - Health: ").concat(a.health,"/").concat(d),children:[(0,n.jsx)("img",{src:a.getImageUrl(),alt:a.type,className:o().inventoryItem}),(0,n.jsx)("div",{className:o().durabilityBar,children:(0,n.jsx)("div",{className:o().durabilityFill,style:{width:"".concat(_,"%"),backgroundColor:h}})}),i&&r&&(0,n.jsxs)("div",{className:o().quickItemTooltip,children:[(0,n.jsxs)("div",{className:o().quickItemName,children:[a.type.charAt(0).toUpperCase()+a.type.slice(1)," Pickaxe"]}),(0,n.jsxs)("div",{className:o().quickItemStats,children:[(0,n.jsxs)("div",{children:["Health: ",a.health,"/",d]}),(0,n.jsxs)("div",{children:["Strength: ",u.strength]}),(0,n.jsxs)("div",{children:["Critical: ",100*u.critical,"%"]}),(0,n.jsxs)("div",{children:["Power: ",u.power]}),(0,n.jsxs)("div",{children:["Rarity: ",u.rarity]})]})]})]})},x=e=>{let{isOpen:a,onClose:t,gameState:c,onSelectPickaxe:l}=e,i=a?"".concat(o().modal," ").concat(o().modalShow):o().modal,r=c.pickaxeInventory,m=r.currentItem,d=r.getCurrentItem(),[_,u]=(0,s.useState)(m),h=_?r.items.find(e=>e.id===_):d,x=e=>{console.log("handlePickaxePreview",e),u(e)};return(0,n.jsx)("div",{className:i,children:(0,n.jsxs)("div",{className:"".concat(o().modalContent," ").concat(o().shopModalContent),children:[(0,n.jsxs)("div",{className:o().modalHeader,children:[(0,n.jsx)("h2",{children:"Inventory"}),(0,n.jsx)("button",{className:o().closeBtn,onClick:t,children:"\xd7"})]}),(0,n.jsxs)("div",{className:o().inventorySection,children:[(0,n.jsx)("h3",{children:"Pickaxes"}),(0,n.jsx)("div",{className:o().pickaxeGrid,children:r.items.map(e=>(0,n.jsx)(k,{pickaxe:e,isSelected:e.id===_,onClick:x,showTooltip:!1},e.id))})]}),h&&(0,n.jsx)("div",{className:o().inventoryDetails,children:(0,n.jsxs)("div",{className:o().selectedItemDetails,children:[(0,n.jsxs)("h4",{children:[h.type," Pickaxe"]}),(0,n.jsxs)("p",{children:["Health: ",h.health," / ",h.getPickaxe().maxHealth]}),(0,n.jsxs)("p",{children:["Strength: ",h.getPickaxe().strength]}),_!==m&&(0,n.jsx)("button",{className:o().selectButton,onClick:()=>{_&&l&&(console.log("handlePickaxeSelect",_),l(_),t())},children:"Select Pickaxe"}),_===m&&(0,n.jsx)("div",{className:o().currentlyEquipped,children:"Currently Equipped"})]})})]})})},v=t(6335),b=e=>{let{isOpen:a,onClose:t,gameState:c,onUnlockBiome:l,onSelectBiome:i,selectionMode:r=!1}=e,d=v.a.items,_=c.unlockedBiomes,u=c.currentBiome.type,h=c.currentBiome.currentHealth<=0,k=(0,s.useRef)(null);console.log("BiomesModal opened - Selection mode: ".concat(r,", Biome destroyed: ").concat(h,", Current health: ").concat(c.currentBiome.currentHealth)),(0,s.useEffect)(()=>{if(a&&k.current){let e=()=>{let e=k.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(o().hasScroll):e.classList.remove(o().hasScroll))};e();let a=new ResizeObserver(e);return a.observe(k.current),()=>{k.current&&a.unobserve(k.current),a.disconnect()}}},[a,d]);let x=e=>_.includes(e.toLowerCase()),b=e=>{l&&l(e.toLowerCase())},p=e=>{i&&x(e)&&(i(e.toLowerCase()),t())},g=e=>{if(x(e))return!0;let a=v.a.getItemByName(e);return!a.cost||c.blockInventory.hasBlock(a.cost.itemType,a.cost.amount)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(o().biomesOverlay," ").concat(a?o().biomesOverlayOpen:""),onClick:t}),(0,n.jsxs)("div",{className:"".concat(o().biomesDrawer," ").concat(a?o().biomesDrawerOpen:""),children:[(0,n.jsx)("div",{className:o().biomesDrawerHandle,onClick:t}),(0,n.jsx)("div",{className:o().biomesDrawerHeader,children:(0,n.jsx)("h2",{children:r?"Select Biome":"Available Biomes"})}),(0,n.jsx)("div",{ref:k,className:o().biomesDrawerContent,"data-drawer-type":"biomes",children:(0,n.jsx)("div",{className:o().biomesSection,children:(0,n.jsx)("div",{className:o().biomesGrid,children:d.map(e=>{let a=x(e.name),t=g(e.name),s=e.name.toLowerCase()===u;return(0,n.jsxs)("div",{className:"".concat(o().biomeItem," \n                                                ").concat(a?o().biomeUnlocked:o().biomeLocked,"\n                                                ").concat(s?o().biomeSelected:""),onClick:()=>a&&r?p(e.name):null,style:{cursor:a&&r?"pointer":"default"},children:[(0,n.jsxs)("div",{className:o().biomeImageContainer,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/biomes/".concat(e.name.toLowerCase(),".png")),alt:e.name,className:o().biomeItemImg}),!a&&(0,n.jsx)("div",{className:o().lockOverlay,children:(0,n.jsx)("img",{src:(0,m.K)("/assets/padlock.svg"),alt:"Locked",className:o().lockIcon})}),(0,n.jsxs)("div",{className:o().biomeNameOverlay,children:[e.name,a&&(0,n.jsx)("span",{className:o().unlockedIndicator,children:"✓"}),s&&(0,n.jsx)("span",{className:o().currentIndicator,children:" (Current)"})]})]}),(0,n.jsxs)("div",{className:o().availableBlocks,children:[(0,n.jsx)("span",{children:"Available Blocks:"}),(0,n.jsx)("div",{className:o().blockImagesContainer,children:e.availableBlocks.map(e=>(0,n.jsxs)("div",{className:o().blockImageWrapper,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/blocks/".concat(e,".png")),alt:e,className:o().blockImage}),(0,n.jsx)("div",{className:o().blockName,children:e})]},e))})]}),(0,n.jsxs)("div",{className:o().availablePickaxes,children:[(0,n.jsx)("span",{children:"Available Pickaxes:"}),(0,n.jsx)("div",{className:o().blockImagesContainer,children:e.availablePickaxes.length>0?e.availablePickaxes.map(e=>(0,n.jsxs)("div",{className:o().blockImageWrapper,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/pickaxes/".concat(e,".png")),alt:e,className:o().blockImage}),(0,n.jsx)("div",{className:o().blockName,children:e})]},e)):(0,n.jsx)("div",{className:o().noPickaxes,children:"No pickaxes available"})})]}),(0,n.jsxs)("div",{className:o().itemInfo,children:[(0,n.jsx)("div",{className:o().itemDescription,children:e.description}),!a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:o().unlockCost,children:e.cost?(0,n.jsxs)(n.Fragment,{children:["Cost: ",(0,n.jsxs)("span",{className:t?o().affordableCost:o().unaffordableCost,children:[e.cost.amount," ",e.cost.itemType]})]}):(0,n.jsx)("span",{className:o().affordableCost,children:"Free"})}),(0,n.jsx)("button",{className:"".concat(o().unlockButton," ").concat(t?"":o().unlockButtonDisabled),onClick:()=>b(e.name),disabled:!t,children:t?"Unlock":"Not enough resources"})]}),a&&r&&!s&&(0,n.jsx)("button",{className:o().selectButton,onClick:()=>p(e.name),children:"Select"})]})]},e.name)})})})})]})]})},p=e=>{let{block:a,className:t="",showTooltip:c=!0}=e,[l,i]=(0,s.useState)(!1),r=a.getBlock();return(0,n.jsxs)("div",{className:"".concat(o().inventorySlot," ").concat(t),title:"".concat(a.name," - Quantity: ").concat(a.quantity),onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)},children:[(0,n.jsx)("img",{src:a.getImageUrl(),alt:a.name,className:o().inventoryItem}),(0,n.jsx)("div",{className:o().itemCount,children:a.quantity}),c&&l&&(0,n.jsxs)("div",{className:o().quickItemTooltip,children:[(0,n.jsx)("div",{className:o().quickItemName,children:a.name.charAt(0).toUpperCase()+a.name.slice(1)}),(0,n.jsxs)("div",{className:o().quickItemStats,children:[(0,n.jsxs)("div",{children:["Quantity: ",a.quantity]}),(0,n.jsxs)("div",{children:["Rarity: ",r.rarity]})]})]})]})};function g(e){let{items:a,totalSlots:t,itemType:s,renderItem:c,renderEmptySlot:l}=e,i=[],r=a.length,m=Math.max(1,Math.ceil(r/t));for(let e=0;e<m;e++){let m=Array(t).fill(null);for(let n=0;n<t;n++){let s=e*t+n;s<r&&(m[n]=a[s])}i.push((0,n.jsx)("div",{className:o().quickInventory,children:m.map((a,t)=>a?c(a,e,t):l(e,t))},"".concat(s,"-row-").concat(e)))}return(0,n.jsx)(n.Fragment,{children:i})}var y=e=>{let{gameState:a,onSelectPickaxe:t}=e,s=a.pickaxeInventory,c=a.blockInventory,l=s.currentItem,i=e=>{t&&e&&t(e)};return(0,n.jsxs)("div",{className:o().quickInventoryContainer,children:[(0,n.jsxs)("div",{className:o().quickInventorySection,children:[(0,n.jsx)("div",{className:o().quickInventoryLabel,children:"Pickaxes"}),(0,n.jsx)(g,{items:s.items,totalSlots:8,itemType:"pickaxe",renderItem:(e,a,t)=>(0,n.jsx)(k,{pickaxe:e,isSelected:e.id===l,onClick:i},e.id),renderEmptySlot:(e,a)=>(0,n.jsx)("div",{className:o().inventorySlot},"pickaxe-empty-".concat(e,"-").concat(a))})]}),(0,n.jsxs)("div",{className:o().quickInventorySection,children:[(0,n.jsx)("div",{className:o().quickInventoryLabel,children:"Blocks"}),(0,n.jsx)(g,{items:c.items,totalSlots:8,itemType:"block",renderItem:(e,a,t)=>(0,n.jsx)(p,{block:e},"block-".concat(e.name,"-").concat(a,"-").concat(t)),renderEmptySlot:(e,a)=>(0,n.jsx)("div",{className:o().inventorySlot},"block-empty-".concat(e,"-").concat(a))})]})]})},I=t(7390),j=t(1499);class N{toggleSound(e){this.soundEnabled=e}preloadSound(e,a){try{let t=new Audio(a);this.sounds.set(e,t)}catch(a){console.error("Error loading sound ".concat(e,": ").concat(a))}}playSound(e){if(this.soundEnabled)try{let a=this.sounds.get(e);a?(a.currentTime=0,a.play().catch(a=>{console.error("Error playing sound ".concat(e,": ").concat(a))})):console.warn('Sound "'.concat(e,'" not found'))}catch(a){console.error("Error playing sound ".concat(e,": ").concat(a))}}constructor(){this.sounds=new Map,this.soundEnabled=!0,this.preloadSound("error","/assets/sounds/error.mp3")}}let G=new N;var B=t(224),C=t(5927);let f=e=>{switch(e){case"Common":default:return 100;case"Uncommon":return 200;case"Rare":return 500;case"Legendary":return 2e3}},w=e=>{switch(e){case"Common":default:return"#aaaaaa";case"Uncommon":return"#55ff55";case"Rare":return"#5555ff";case"Legendary":return"#ffaa00"}};var S=e=>{let{isOpen:a,onClose:t,gameState:c,onBuyBlock:l}=e,i=c.currentBiome.getBiome(),r=i.availableBlocks||[],m=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(a&&m.current){let e=()=>{let e=m.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(o().hasScroll):e.classList.remove(o().hasScroll))};e();let a=new ResizeObserver(e);return a.observe(m.current),()=>{m.current&&a.unobserve(m.current),a.disconnect()}}},[a,r]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"".concat(o().biomesOverlay," ").concat(a?o().biomesOverlayOpen:""),onClick:t}),(0,n.jsxs)("div",{className:"".concat(o().biomesDrawer," ").concat(a?o().biomesDrawerOpen:""),children:[(0,n.jsx)("div",{className:o().biomesDrawerHandle,onClick:t}),(0,n.jsx)("div",{className:o().biomesDrawerHeader,children:(0,n.jsxs)("h2",{children:["Buy Blocks from ",i.name," biome"]})}),(0,n.jsx)("div",{ref:m,className:o().biomesDrawerContent,"data-drawer-type":"blocks",children:(0,n.jsxs)("div",{className:o().biomesSection,children:[(0,n.jsxs)("p",{children:["Your picks: ",c.picks]}),0===r.length?(0,n.jsx)("p",{children:"No blocks available in this biome."}):(0,n.jsx)("div",{className:o().blocksGrid,children:r.map(e=>{let a=new C.f({name:e,quantity:1}),t=a.getImageUrl(),s=a.getBlock().rarity,r=f(s),m=c.picks>=r,d=w(s);return(0,n.jsxs)("div",{className:o().blockItem,children:[(0,n.jsxs)("div",{className:o().blockImageContainer,children:[(0,n.jsx)("img",{src:t,alt:e,className:o().blockItemImg}),(0,n.jsx)("div",{className:o().blockNameOverlay,children:e}),(0,n.jsx)("div",{className:o().rarityBadge,style:{backgroundColor:d},children:s})]}),(0,n.jsxs)("div",{className:o().blockItemContent,children:[(0,n.jsxs)("div",{className:o().blockDescription,children:["A ",s.toLowerCase()," ",e," block from the ",i.name," biome."]}),(0,n.jsx)("button",{className:"".concat(o().buyBlockButton," ").concat(m?"":o().buyBlockButtonDisabled),onClick:()=>l(e),disabled:!m,children:m?"Buy (".concat(r," picks)"):"Need ".concat(r," picks")})]})]},e)})})]})})]})]})},P=()=>{let[e,a]=(0,s.useState)(!1),[t,c]=(0,s.useState)(I.ZP.loadGameState()),[d,k]=(0,s.useState)({num1:0,num2:0,operator:"+",answer:0}),[p,g]=(0,s.useState)(""),[N,f]=(0,s.useState)(!1),[w,P]=(0,s.useState)(!1),[H,D]=(0,s.useState)(!1),[O,T]=(0,s.useState)(!1),[q,L]=(0,s.useState)(!1),[M,A]=(0,s.useState)(!1),[E,F]=(0,s.useState)(""),[U,R]=(0,s.useState)(!1),[K,z]=(0,s.useState)(""),[Y,Z]=(0,s.useState)(!1),[W,X]=(0,s.useState)(!1),[Q,V]=(0,s.useState)(null),[J,$]=(0,s.useState)(null),[ee,ea]=(0,s.useState)(null),[et,en]=(0,s.useState)(!1),es=(0,s.useRef)(null);(0,s.useEffect)(()=>{a(!0),k(I.ZP.generateMathProblem()),c(I.ZP.loadGameState())},[]),(0,s.useEffect)(()=>{e&&!N&&I.ZP.saveGameState(t)},[t,e,N]),(0,s.useEffect)(()=>{console.log("gameState",t);let e=t.currentBiome;e.currentHealth<=0&&(console.log("Biome destroyed! Opening selection modal..."),z(e.type),R(!0),setTimeout(()=>{R(!1)},3e3))},[t]),(0,s.useEffect)(()=>{q&&es.current&&setTimeout(()=>{var e;null===(e=es.current)||void 0===e||e.focus()},100)},[q]);let ec=()=>{k(I.ZP.generateMathProblem()),g("")},eo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=t.pickaxeInventory.getCurrentItem();n&&(V(e=e||n.getPicks()),setTimeout(()=>{V(null)},2e3)),el(),c(t=>{let s=t.increasePicks(e||0);if(n&&a){let e=t.currentBiome.withDamage(n.getDamageToBiome(t.currentBiome.getBiome()));return console.log("Biome health: ".concat(e.currentHealth,"/").concat(e.getBiome().maxHealth)),s.withCurrentBiome(e)}return console.log("No current pickaxe found"),t})},el=()=>{let e=t.pickaxeInventory.getCurrentItem();if(e&&Math.random()<e.getPickaxe().critical){let e=t.currentBiome;if(!e)return;let a=e.getBiome().availableBlocks;if(a&&a.length>0){let e=Math.floor(Math.random()*a.length),t=a[e],n=new C.f({name:t,quantity:1});$({name:t,imageUrl:n.getImageUrl()}),ea(n),setTimeout(()=>{ea(null)},3e3),c(e=>{let a=e.blockInventory.addBlock(t,1);return e.withBlockInventory(a)})}}},ei=()=>{Z(!0),X(!0),G.playSound("error"),document.body.classList.add("screen-shake"),setTimeout(()=>{X(!1)},1e3),setTimeout(()=>{Z(!1),document.body.classList.remove("screen-shake")},500),c(e=>{let a=e.pickaxeInventory.getCurrentItem();if(null===a)return e;let t=a.withDamage(1),n=new j.t({id:t.id,type:t.type,health:t.health});if(n.health<=0)return er(e);let s=e.pickaxeInventory.withCurrentItem(n);return e.withPickaxeInventory(s)})},er=e=>{let a=e.pickaxeInventory.getCurrentItem();if(!a)return e;if(F(a.type),A(!0),setTimeout(()=>{A(!1)},3e3),e.pickaxeInventory.length<=1)return f(!0),e;let t=e.pickaxeInventory.removeCurrentItem();return e.withPickaxeInventory(t)},em=()=>{P(e=>!e)},ed=()=>{D(e=>!e)},e_=()=>{T(e=>!e)},eu=()=>{en(e=>!e)},eh=e=>{if(!t.pickaxeInventory.items.find(a=>a.id===e)){console.error("Selected pickaxe not found in inventory");return}let a=t.pickaxeInventory.withCurrentItemId(e);c(e=>{let t=e.withPickaxeInventory(a);return setTimeout(()=>{I.ZP.saveGameState(t)},0),t}),D(!1)};return(t.pickaxeInventory.length,e)?(0,n.jsxs)("div",{className:o().gameContainer,children:[(0,n.jsxs)("div",{className:o().gameHeader,children:[(0,n.jsx)("h1",{children:"MathCrafter"}),(0,n.jsx)("div",{className:o().avatar,children:(0,n.jsx)("img",{src:(0,m.K)("/assets/avatars/avatar.png"),alt:"Player Avatar",className:o().avatarImage,onClick:ed,style:{cursor:"pointer"}})}),(0,n.jsx)("div",{className:o().stats,children:(0,n.jsxs)("div",{className:o().statItem,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/picks.png"),alt:"Picks",className:o().picksIcon}),(0,n.jsx)("span",{children:t.picks})]})}),(0,n.jsxs)("div",{className:o().headerButtons,children:[(0,n.jsxs)("button",{className:o().pickaxesButton,onClick:em,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/shop_pickaxe.png"),alt:"Pickaxes",className:o().buttonIcon}),"Pickaxes"]}),(0,n.jsxs)("button",{className:o().unlockBiomesButton,onClick:e_,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/unlock_biome.png"),alt:"Biomes",className:o().buttonIcon}),"Biomes"]}),(0,n.jsxs)("button",{className:o().buyBlocksButton,onClick:eu,children:[(0,n.jsx)("img",{src:(0,m.K)("/assets/blocks.png"),alt:"Blocks",className:o().buttonIcon}),"Blocks"]})]})]}),(0,n.jsxs)("div",{className:o().gameArea,children:[(0,n.jsx)(h,{onBiomeClick:()=>{if(q)return;let e=t.pickaxeInventory.getCurrentItem();e&&(Math.random()<=e.getPickaxe().critical?(L(!0),ec()):eo(e.getPickaxe().strength,!1))},currentPickaxe:t.pickaxeInventory.getCurrentItem(),currentBiome:t.currentBiome,picksToShow:Q,minedBlock:J}),(0,n.jsx)(y,{gameState:t,onSelectPickaxe:eh})]}),(0,n.jsx)("div",{className:"".concat(o().modal," ").concat(q?o().modalShow:""),children:(0,n.jsxs)("div",{className:"".concat(o().modalContent," ").concat(o().questionModalContent),children:[(0,n.jsxs)("div",{className:o().modalHeader,children:[(0,n.jsx)("h2",{children:"Math Problem"}),(0,n.jsx)("button",{className:o().closeBtn,onClick:()=>{L(!1)},children:"\xd7"})]}),(0,n.jsxs)("form",{className:"".concat(o().mathProblem," ").concat(Y?o().wrongAnswerShake+" "+o().wrongAnswerFlash:""),onSubmit:e=>{e.preventDefault();let a=parseInt(p);isNaN(a)||(a===d.answer?(eo(null,!0),ec(),g(""),L(!1)):(ei(),g("")))},children:[(0,n.jsxs)("div",{className:o().question,children:[d.num1," ",d.operator," ",d.num2," = ?"]}),(0,n.jsxs)("div",{className:o().answerArea,children:[(0,n.jsx)("input",{ref:es,type:"number",className:o().answer,value:p,onChange:e=>g(e.target.value),autoFocus:!0}),(0,n.jsx)("button",{type:"submit",className:o().submitBtn,children:"Mine!"})]}),(0,n.jsxs)("div",{className:o().numpad,children:[[7,8,9,4,5,6,1,2,3,0].map(e=>(0,n.jsx)("button",{type:"button",className:o().numpadBtn,onClick:()=>g(a=>a+e.toString()),children:e},e)),(0,n.jsx)("button",{type:"button",className:"".concat(o().numpadBtn," ").concat(o().clearBtn),onClick:()=>g(""),children:"Clear"}),(0,n.jsx)("button",{type:"button",className:"".concat(o().numpadBtn," ").concat(o().deleteBtn),onClick:()=>g(e=>e.slice(0,-1)),children:"←"})]})]})]})}),W&&(0,n.jsx)("div",{className:o().incorrectText,children:"INCORRECT!"}),(0,n.jsx)(_,{isOpen:w,onClose:em,gameState:t,onBuyItem:(e,a)=>{let n=r.o.getItemByName(e);if(!n){console.error("Pickaxe with name ".concat(e," not found"));return}let s=n.cost.itemType,o=n.cost.amount;if(!t.blockInventory.hasBlock(s,o)){console.error("Not enough ".concat(s," to craft ").concat(e," pickaxe"));return}let l=new j.t({id:null,type:e,health:null}),i=t.blockInventory;i=i.addBlock(s,-o);let m=new B.C0({items:[...t.pickaxeInventory.items,l],currentItem:l.id});c(t.withPickaxeInventory(m).withBlockInventory(i))}}),(0,n.jsx)(x,{isOpen:H,onClose:ed,gameState:t,onSelectPickaxe:eh}),(0,n.jsx)(b,{isOpen:O,onClose:e_,gameState:t,onUnlockBiome:e=>{if(t.unlockedBiomes.includes(e))return;let a=v.a.getItemByName(e);if(!a){console.error("Biome with name ".concat(e," not found"));return}if(a.cost){let n=a.cost.itemType,s=a.cost.amount;if(!t.blockInventory.hasBlock(n,s)){console.error("Not enough ".concat(n," to unlock ").concat(e," biome"));return}c(a=>{let t=a.blockInventory;t=t.addBlock(n,-s);let c=[...a.unlockedBiomes,e];return new l.D({...a,unlockedBiomes:c,blockInventory:t})})}else c(a=>{let t=[...a.unlockedBiomes,e];return new l.D({...a,unlockedBiomes:t})})},onSelectBiome:e=>{c(a=>{let t=new i.k({id:null,type:e,currentHealth:null});return a.withCurrentBiome(t)})},selectionMode:!0}),(0,n.jsx)(S,{isOpen:et,onClose:eu,gameState:t,onBuyBlock:e=>{t.picks<100||c(a=>{let t=a.increasePicks(-100),n=t.blockInventory.addBlock(e,1);return ea(new C.f({name:e,quantity:1})),setTimeout(()=>{ea(null)},3e3),t.withBlockInventory(n)})}}),(0,n.jsx)(u,{isOpen:N,onRestart:()=>{let e=I.ZP.loadGameState();c(e),f(!1),L(!1),ec(),I.ZP.saveGameState(e)}}),M&&(0,n.jsxs)("div",{className:o().brokenPickaxeNotification,children:[(0,n.jsx)("h3",{children:"Pickaxe Destroyed!"}),(0,n.jsxs)("p",{children:["Your ",E," Pickaxe has broken."]})]}),U&&(0,n.jsxs)("div",{className:o().biomeDestroyedNotification,children:[(0,n.jsx)("h3",{children:"Biome Conquered!"}),(0,n.jsxs)("p",{children:["You've mined the ",K," biome."]}),(0,n.jsx)("p",{children:"Please select a new biome to explore!"})]}),ee&&(0,n.jsxs)("div",{className:o().blockAddedNotification,children:[(0,n.jsx)("img",{src:ee.getImageUrl(),alt:ee.name}),(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:["+1 ",ee.name]})})]})]}):(0,n.jsx)("div",{className:o().gameContainer,children:"Loading..."})}},6784:function(e){e.exports={gameContainer:"Game_gameContainer__DCVxw",gameHeader:"Game_gameHeader__jef7Y",headerButtons:"Game_headerButtons__B8wAT",pickaxesButton:"Game_pickaxesButton___3L1u",inventoryButton:"Game_inventoryButton__zDRef",buttonIcon:"Game_buttonIcon__GZTyW",stats:"Game_stats__AXLa3",avatar:"Game_avatar__WGgR4",avatarImage:"Game_avatarImage__6K_UX",statItem:"Game_statItem__Ej0sS",statIcon:"Game_statIcon__EGYV8",gameArea:"Game_gameArea__GjGTz",biomeContainer:"Game_biomeContainer__dvKa1",biome:"Game_biome__K3Z90",shake:"Game_shake__cK_dY",desert:"Game_desert__59lr4",pickaxeCursor:"Game_pickaxeCursor__VrlXH",swingAnimation:"Game_swingAnimation__J3dxl",swing:"Game_swing__qyeYb",crack:"Game_crack__ZJr8u",biomeGrid:"Game_biomeGrid__YYxIa",biomeBlock:"Game_biomeBlock__hlTQK",hoveredBlock:"Game_hoveredBlock__5vRWz",crackedBlock:"Game_crackedBlock__U8CK6",damageSpot:"Game_damageSpot__Zc_DO",fadeOut:"Game_fadeOut__PXbw4",crackOverlay:"Game_crackOverlay__mUKXl",secondaryCracks:"Game_secondaryCracks__KqY1e",pulse:"Game_pulse__7Akc_",criticalCracks:"Game_criticalCracks__hctP5",pulseCritical:"Game_pulseCritical__eaqtV",verticalHealthContainer:"Game_verticalHealthContainer__QVrRO",verticalHealthBar:"Game_verticalHealthBar__Tn4cQ",verticalHealthText:"Game_verticalHealthText__VWYIO",horizontalHealthContainer:"Game_horizontalHealthContainer__U_KQk",horizontalHealthBar:"Game_horizontalHealthBar__wMR8i",horizontalHealthText:"Game_horizontalHealthText__3op2q",gemstone:"Game_gemstone__Pzzoa",pop:"Game_pop__kIeLx",mathProblem:"Game_mathProblem__cbFZ4",question:"Game_question__75OVD",answerArea:"Game_answerArea__yO3SB",answer:"Game_answer__RS4lw",numpad:"Game_numpad__EsEnF",numpadBtn:"Game_numpadBtn__EZ10M",clearBtn:"Game_clearBtn__KlC5c",deleteBtn:"Game_deleteBtn__KQDIh",submitBtn:"Game_submitBtn__bt_xx",shopPanel:"Game_shopPanel__x6_s6",pickaxesItems:"Game_pickaxesItems__5qS0e",pickaxesItem:"Game_pickaxesItem__UM5X6",shopItemImg:"Game_shopItemImg__SNjeb",itemTooltip:"Game_itemTooltip__96Agx",fadeIn:"Game_fadeIn__kMifl",itemInfo:"Game_itemInfo__QIOMm",itemName:"Game_itemName__kAkjd",itemStats:"Game_itemStats__KXzBA",itemCost:"Game_itemCost__HrN00",buyBtn:"Game_buyBtn__4An2v",affordableCost:"Game_affordableCost__P__wd",unaffordableCost:"Game_unaffordableCost__viXO3",modal:"Game_modal__2pRTh",modalShow:"Game_modalShow__bynoR",modalContent:"Game_modalContent__P7w0X",modalHeader:"Game_modalHeader__Z_kNk",closeBtn:"Game_closeBtn__lFsNh",shopModalContent:"Game_shopModalContent__FXQeH",pickaxesModalContent:"Game_pickaxesModalContent__WNmK7",restartBtn:"Game_restartBtn__Lb4tw",inventoryRow:"Game_inventoryRow__7GSrm",inventorySlot:"Game_inventorySlot__8sAaP",selected:"Game_selected__BQ8Ic",inventoryItem:"Game_inventoryItem__V_hWy",itemCount:"Game_itemCount__SwmcS",slotNumber:"Game_slotNumber__03ear",durabilityBar:"Game_durabilityBar__qeq2x",durabilityFill:"Game_durabilityFill__cGHw2",medium:"Game_medium__0wKzQ",low:"Game_low__dJaRD",inventorySection:"Game_inventorySection__adyfa",pickaxeGrid:"Game_pickaxeGrid__1E9G2",inventoryDetails:"Game_inventoryDetails__FwwYr",selectedItemDetails:"Game_selectedItemDetails__WhpFd",selectButton:"Game_selectButton__XfYI_",currentlyEquipped:"Game_currentlyEquipped__M1NP5",quickInventoryContainer:"Game_quickInventoryContainer__y_YTY",quickInventorySection:"Game_quickInventorySection__3mFz0",quickInventoryLabel:"Game_quickInventoryLabel__Nt4so",quickInventory:"Game_quickInventory__Cz9Og",quickItemTooltip:"Game_quickItemTooltip__zlhuV",pickaxeHealth:"Game_pickaxeHealth__QHgq6",lowHealth:"Game_lowHealth__XJ4kF",mediumHealth:"Game_mediumHealth__v_BZ1",goodHealth:"Game_goodHealth__tTZ_a",brokenPickaxeNotification:"Game_brokenPickaxeNotification__dUA5g",fadeInOut:"Game_fadeInOut__xlUoa",unlockBiomesButton:"Game_unlockBiomesButton__E8UsO",biomesModalContent:"Game_biomesModalContent__HtN_N",biomesSection:"Game_biomesSection__AIv_y",biomesGrid:"Game_biomesGrid__e3nXY",biomesDrawerContent:"Game_biomesDrawerContent__5ELj0",biomeItem:"Game_biomeItem__zhlo9",biomeImageContainer:"Game_biomeImageContainer__nU75s",biomeItemImg:"Game_biomeItemImg__JVH51",availableBlocks:"Game_availableBlocks__fLSy6",blockImagesContainer:"Game_blockImagesContainer__hCEhC",blockImageWrapper:"Game_blockImageWrapper__vZauU",blockImage:"Game_blockImage__P1NCd",blockName:"Game_blockName__jg9L4",biomeNameOverlay:"Game_biomeNameOverlay__yZ4Hb",biomeUnlocked:"Game_biomeUnlocked__ZZlLU",biomeLocked:"Game_biomeLocked__6vjWm",lockOverlay:"Game_lockOverlay__gYBfb",lockIcon:"Game_lockIcon__hlC2P",unlockedIndicator:"Game_unlockedIndicator__z_Y_M",unlockButton:"Game_unlockButton__cls4_",unlockCost:"Game_unlockCost__MR6TD",unlockButtonDisabled:"Game_unlockButtonDisabled__5Wofl",biomeSelected:"Game_biomeSelected__FPWT3",currentIndicator:"Game_currentIndicator__PCrVR",biomeDestroyedNotification:"Game_biomeDestroyedNotification__zLwhW",biomeDestroyed:"Game_biomeDestroyed__Q4f_u",destroyedOverlay:"Game_destroyedOverlay__St_OS",pulseOverlay:"Game_pulseOverlay__D9v8Y",wrongAnswerShake:"Game_wrongAnswerShake__oXjjO",wrongAnswerFlash:"Game_wrongAnswerFlash__LoOkO",incorrectText:"Game_incorrectText__XtzyJ",showIncorrect:"Game_showIncorrect__FBH48",scoreFlash:"Game_scoreFlash__IHTpA",showScore:"Game_showScore__O_8bK",minedBlock:"Game_minedBlock__YX8Br",blockPopUp:"Game_blockPopUp__YhGuR",blockAddedNotification:"Game_blockAddedNotification__pS9z4",slideIn:"Game_slideIn__8tAS3",quickItemName:"Game_quickItemName__Nyasz",quickItemStats:"Game_quickItemStats__VoF8k",buyBlocksButton:"Game_buyBlocksButton__k2Nva",picksIcon:"Game_picksIcon__EDa41",biomesDrawer:"Game_biomesDrawer__Ilqv3",biomesDrawerOpen:"Game_biomesDrawerOpen__DCAr2",biomesDrawerHandle:"Game_biomesDrawerHandle__mNtur",hasScroll:"Game_hasScroll__lCm9L",biomesDrawerHeader:"Game_biomesDrawerHeader__DJA95",toggleContainer:"Game_toggleContainer__CgOZ7",toggleSwitch:"Game_toggleSwitch___IPd1",toggleSlider:"Game_toggleSlider__r7Hn8",toggleLabel:"Game_toggleLabel__FjOEF",biomesOverlay:"Game_biomesOverlay__fwGLK",biomesOverlayOpen:"Game_biomesOverlayOpen__JzSiZ",itemDescription:"Game_itemDescription__ikR7Z",blocksGrid:"Game_blocksGrid__LDEm1",blockItem:"Game_blockItem__vaqUW",blockImageContainer:"Game_blockImageContainer__zHzYs",blockItemImg:"Game_blockItemImg__BLIhi",blockNameOverlay:"Game_blockNameOverlay__0Tyfs",blockItemContent:"Game_blockItemContent__NGBwy",blockDescription:"Game_blockDescription__E1g8H",buyBlockButton:"Game_buyBlockButton__g5no3",buyBlockButtonDisabled:"Game_buyBlockButtonDisabled__8WG2u",pickaxesGrid:"Game_pickaxesGrid__hKWxc",pickaxeItem:"Game_pickaxeItem__TK3h7",pickaxeImageContainer:"Game_pickaxeImageContainer__WG56E",pickaxeItemImg:"Game_pickaxeItemImg__1RYiu",pickaxeItemContent:"Game_pickaxeItemContent__MSetD",pickaxeInfo:"Game_pickaxeInfo__918A8",buyPickaxeButton:"Game_buyPickaxeButton__7dMEP",buyPickaxeButtonDisabled:"Game_buyPickaxeButtonDisabled__RiUFp",noPickaxes:"Game_noPickaxes__KUcga",availablePickaxes:"Game_availablePickaxes__8a1gP",rarityBadge:"Game_rarityBadge___YQYs",questionModalContent:"Game_questionModalContent__VK_qs"}}}]);